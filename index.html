<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="人生充满着期待，梦想连接着未来。">
<meta name="keywords" content="C#,wpf,html5,vue2,javascript,net core,">
<meta property="og:type" content="website">
<meta property="og:title" content="jingge">
<meta property="og:url" content="http://www.geeee.top/index.html">
<meta property="og:site_name" content="jingge">
<meta property="og:description" content="人生充满着期待，梦想连接着未来。">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="jingge">
<meta name="twitter:description" content="人生充满着期待，梦想连接着未来。">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.geeee.top/"/>





  <title>jingge</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">jingge</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/./404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            公益404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.geeee.top/2019/01/20/js-this/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jingge">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jingge">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/20/js-this/" itemprop="url">JS中this的那些事儿</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-01-20T10:27:22+08:00">
                2019-01-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/" itemprop="url" rel="index">
                    <span itemprop="name">前端</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2019/01/20/js-this/" class="leancloud_visitors" data-flag-title="JS中this的那些事儿">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>this是JavaScript中最复杂的机制之一。它是一个很特别的关键字，被自动定义在所有函数的作用域中。</p>
</blockquote>
<h3 id="一、this到底指向什么？"><a href="#一、this到底指向什么？" class="headerlink" title="一、this到底指向什么？"></a>一、this到底指向什么？</h3><p>this既不指向函数自身，也不指向函数的词法作用域，具体指向什么，取决于你是怎么调用函数。</p>
<ol>
<li><strong>直接使用不带任何修饰的函数引用进行调用（即：方法名 + 括号）， this指向全局对象（非严格模式）或者undefined（严格模式），</strong> 这种绑定称为默认绑定</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line">    console.log(this.a);</span><br><span class="line">&#125;</span><br><span class="line">var a = 2;</span><br><span class="line">foo();  // 2</span><br></pre></td></tr></table></figure>
<p>严格模式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line">    &quot;use strict&quot;</span><br><span class="line">    console.log(this.a);</span><br><span class="line">&#125;</span><br><span class="line">var a = 2;</span><br><span class="line">foo();  // undefiend</span><br></pre></td></tr></table></figure>
<ol start="2">
<li><strong>如果方法是某个对象的一个属性，通过该对象调用方法（即调用位置存在上下文对象），则this指向该对象，</strong> 这种绑定称为隐式绑定.</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line">    console.log(this.a);</span><br><span class="line">&#125;</span><br><span class="line">var obj = &#123;</span><br><span class="line">    a: 2,</span><br><span class="line">    foo: foo</span><br><span class="line">&#125;</span><br><span class="line">obj.foo();  // 2</span><br></pre></td></tr></table></figure>
<p>注意事项</p>
<ul>
<li>如果多个对象之间形成了引用链，方法中的this指向其最顶层或者最后一层对象。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line">    console.log(this.a);</span><br><span class="line">&#125;</span><br><span class="line">var obj1 = &#123;</span><br><span class="line">    a: 42,</span><br><span class="line">    foo: foo</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var obj2 = &#123;</span><br><span class="line">    a: 3,</span><br><span class="line">    obj1: obj1</span><br><span class="line">&#125;</span><br><span class="line">obj2.obj1.foo() // 42</span><br></pre></td></tr></table></figure>
<ul>
<li>隐式丢失，被隐式绑定的函数会丢失绑定对象，也即会应用默认绑定，从而把this绑定到全局对象或者undefined上。<br>这种情况常出现在回调函数上：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line">    console.log(this.a);</span><br><span class="line">&#125;</span><br><span class="line">function doFoo(fn) &#123;</span><br><span class="line">    // fn 其实引用的是foo</span><br><span class="line">    fn();</span><br><span class="line">&#125;</span><br><span class="line">var obj = &#123;</span><br><span class="line">    a: 2,</span><br><span class="line">    foo: foo</span><br><span class="line">&#125;</span><br><span class="line">var a = &quot;oops, global&quot;;</span><br><span class="line"></span><br><span class="line">doFoo(obj.foo)      // 输出&quot;oops, global&quot;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li><p><strong>使用call, apply方法调该函数时，this指向call,apply方法所传入的对象</strong>，这种方式成为显示绑定</p>
<p> js中几乎所有的函数都有call()和apply()方法，这两个方法的第一个参数是一个对象，他们会把这个对象绑定到this.</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line">    console.log(this.a);</span><br><span class="line">&#125;</span><br><span class="line">var obj = &#123;</span><br><span class="line">    a: 2,</span><br><span class="line">&#125;</span><br><span class="line">foo.call(obj);      // 2</span><br></pre></td></tr></table></figure>
<p>显示绑定仍然存在绑定丢失的问题：例如</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line">	console.log(this.a);</span><br><span class="line">&#125;</span><br><span class="line">function doFoo(fn) &#123;</span><br><span class="line">	fn();</span><br><span class="line">&#125;</span><br><span class="line">var obj = &#123;</span><br><span class="line">	a: 2,</span><br><span class="line">&#125;</span><br><span class="line">var a = &quot;oops, global&quot;;</span><br><span class="line"></span><br><span class="line">doFoo.call(obj, foo);   // 输出oops, global</span><br></pre></td></tr></table></figure>
<p>解决办法：</p>
<ul>
<li>++硬绑定++<br>在doFoo函数内，直接绑定obj对象</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function doFoo(fn) &#123;</span><br><span class="line">    fn.call(obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>硬绑定一种常见的应用常见是创建一个可重复使用的辅助函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">function foo(something) &#123;</span><br><span class="line">    console.log(this.a, something);</span><br><span class="line">    return this.a + something;</span><br><span class="line">&#125;</span><br><span class="line">// 简单的辅助绑定函数</span><br><span class="line">function bind(fn, obj) &#123;</span><br><span class="line">    return function() &#123;</span><br><span class="line">        return fn.apply(obj, arguments);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">var obj = &#123;a:2&#125;;</span><br><span class="line">var bar = bind(foo, obj);</span><br><span class="line">var b = bar(3); // 输出2 3</span><br><span class="line">console.log(b); // 输出5</span><br></pre></td></tr></table></figure>
<p>ES5中提供了内置的硬绑定的方法： Function.prototype.bind, 用法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function foo(something) &#123;</span><br><span class="line">    console.log(this.a, something);</span><br><span class="line">    return this.a + something;</span><br><span class="line">&#125;</span><br><span class="line">var obj = &#123;</span><br><span class="line">    a:2;</span><br><span class="line">&#125;</span><br><span class="line">var bar = foo.bind(obj);</span><br><span class="line">var b = bar(3);  // 2 3</span><br><span class="line">console.log(b);  // 5</span><br></pre></td></tr></table></figure>
<p>bind(..) 会返回一个硬编码的新函数，它会把参数设置为 this的上下文并调用原始函数。</p>
<ol start="4">
<li><strong>new绑定</strong></li>
</ol>
<p>在javascript中，所有的函数都可以用new来调用，这种函数调用被称为构造函数调用。使用new来调用函数时，会自动执行下面操作：</p>
<pre><code>1. 创建一个全新的对象;
2. 这个新对象会被执行[[原型]链接;
3. 这个新对象会绑定到函数调用的this
4. 如果函数没有返回其他对象，那么new表达式中的函数调用会自动返回这个新对象
</code></pre><p>示例：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function foo(a) &#123;</span><br><span class="line">    this.a = a; // 在这里，this绑定到bar对象</span><br><span class="line">&#125;</span><br><span class="line">var bar = new foo(2);</span><br><span class="line">console.log(bar.a);     // 2</span><br></pre></td></tr></table></figure></p>
<h3 id="二、如果函数调用时，既满足隐式绑定、又满足显示绑定或new绑定，该怎么办？"><a href="#二、如果函数调用时，既满足隐式绑定、又满足显示绑定或new绑定，该怎么办？" class="headerlink" title="二、如果函数调用时，既满足隐式绑定、又满足显示绑定或new绑定，该怎么办？"></a>二、如果函数调用时，既满足隐式绑定、又满足显示绑定或new绑定，该怎么办？</h3><p>new绑定优先级  &gt;  显示绑定   &gt;   隐式绑定 &gt; 默认绑定</p>
<ul>
<li><p>比较显示绑定和隐式绑定，new绑定和隐式绑定 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function foo(something) &#123;</span><br><span class="line">    this.a = something;</span><br><span class="line">&#125;</span><br><span class="line">var obj1 = &#123;foo: foo&#125;;</span><br><span class="line">var obj2 = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">obj1.foo.call(obj2, 3);     // foo函数的调用同时出现了隐式绑定和显示绑定，则显示绑定优先，this指向 obj2</span><br><span class="line">console.log(obj2.a);        // obj2.a = 3</span><br><span class="line"></span><br><span class="line">var bar = new obj1.foo(4);  // 同时出现了隐式绑定和new绑定， this指向new绑定创建的对象bar, 而不是obj1</span><br><span class="line">console.log(bar.a);         // 输出4</span><br></pre></td></tr></table></figure>
</li>
<li><p>比较new绑定和显示绑定：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">function foo(something) &#123;</span><br><span class="line">    this.a = something;</span><br><span class="line">&#125;</span><br><span class="line">var obj1 = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">var bar = foo.bind( obj1 );</span><br><span class="line"></span><br><span class="line">bar( 2 );</span><br><span class="line"></span><br><span class="line">console.log( obj1.a ); // 2</span><br><span class="line"></span><br><span class="line">var baz = new bar(3);</span><br><span class="line"></span><br><span class="line">console.log( obj1.a ); // 2</span><br><span class="line"></span><br><span class="line">console.log( baz.a ); // 3</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>bar 被硬绑定到 obj1 上，但是 new bar(3) 并没有像我们预计的那样把 obj1.a<br>修改为 3。相反， new 修改了硬绑定（到 obj1 的）调用 bar(..) 中的 this</p>
<h3 id="三、特殊情况"><a href="#三、特殊情况" class="headerlink" title="三、特殊情况"></a>三、特殊情况</h3><ol>
<li>调用call或者apply时，参数传入null或者undefined， 此时this会采用默认绑定</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line">    console.log(this.a);</span><br><span class="line">&#125;</span><br><span class="line">var a = 2;</span><br><span class="line">foo.call(null); // 输出2</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>函数的间接引用，此时this采用默认绑定。间接引用最常在赋值时发生：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line">    console.log(this.a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var a = 2;</span><br><span class="line">var o = &#123; a: 3, foo: foo &#125;;</span><br><span class="line">var p = &#123; a: 4 &#125;;</span><br><span class="line">o.foo(); // 3</span><br><span class="line">(p.foo = o.foo)(); // 2</span><br></pre></td></tr></table></figure>
<p>赋值表达式 p.foo = o.foo 的返回值是目标函数的引用，因此调用位置是 foo() 而不是p.foo() 或者 o.foo()</p>
<ol start="3">
<li><strong>箭头函数</strong> </li>
</ol>
<p>前面提到的四种绑定规则对箭头函数不适用，箭头函数中的this是根据外层作用域来决定的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line">    return (a) =&gt; &#123;</span><br><span class="line">        console.log(this.a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var obj1 = &#123;a:2&#125;;</span><br><span class="line">var obj2 = &#123;a:3&#125;;</span><br><span class="line"></span><br><span class="line">var bar = foo.call(obj1); // 箭头函数的外层作用域中的this指向 obj1, 所以箭头函数中this也指向obj1，箭头函数的绑定无法被修改</span><br><span class="line">bar.call(obj2);     // 输出2，</span><br></pre></td></tr></table></figure>
<h3 id="四、-小结"><a href="#四、-小结" class="headerlink" title="四、 小结"></a>四、 小结</h3><p>判断一个运行中函数的this绑定，就需要找到这个函数的直接调用位置，找到后就可以顺序应用这四条规则判断this的绑定对象。</p>
<ol>
<li>由new调用？ 绑定到新创建的对象；</li>
<li>由call或者apply调用？绑定到指定对象；</li>
<li>由上下文调用？绑定到上下文对象；</li>
<li>默认：严格模式下绑定到undefined，否则绑定到全局对象；</li>
</ol>
<p>另外还需要注意上面提到的几种特殊情况。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.geeee.top/2018/11/09/vuex/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jingge">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jingge">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/11/09/vuex/" itemprop="url">vuex学习总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-09T14:15:45+08:00">
                2018-11-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/" itemprop="url" rel="index">
                    <span itemprop="name">前端</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/Vue/" itemprop="url" rel="index">
                    <span itemprop="name">Vue</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/11/09/vuex/" class="leancloud_visitors" data-flag-title="vuex学习总结">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="什么是Vuex？"><a href="#什么是Vuex？" class="headerlink" title="什么是Vuex？"></a>什么是Vuex？</h2><p>官网定义：</p>
<blockquote>
<p>Vuex 是一个专为 Vue.js 应用程序开发的状态管理模式。它采用<strong>集中式</strong>存储管理应用的所有组件的状态，并以相应的规则保证状态以一种可预测的方式发生变化。</p>
</blockquote>
<p>这段话说明vuex有两个特点：集中管理、状态变化可以预测。 在介绍这两个特点之前，先了解下什么是状态，以及为什么要对状态进行管理。</p>
<ul>
<li><p><strong>状态是驱动应用的数据源</strong>。</p>
<p>  通俗的讲就是组件中绑定的数据。例如：导航控件绑定的菜单数据、控制导航展开或收拢的数据等等。</p>
</li>
</ul>
<ul>
<li><p><strong>为什么要状态管理？</strong></p>
<p>  既然状态是组件需要绑定的数据，那为什么不直接写在组件的data方法里呢？当这个状态只在一个组件中使用时，当然直接在data中定义就可以。但是当多个组件都依赖同一个状态或者都会修改同一个状态时，处理起来就比较麻烦。</p>
<p>  因为在vue中，组件通过prop注册自定义属性。父组件通过给子组件的自定义属性赋值将数据传给子组件。另外子组件不能直接修改父组件的数据，它可以emit一个事件，将变更后的数据通过事件参数传给父组件，父组件捕获到事件后更新数据。 这样的话对下面这些场景处理起来就很麻烦：</p>
<ol>
<li>两个兄弟关系（或者毫无关系）的组件都依赖于同一个状态，A组件修改状态后，B组件也要更新；此时A组件无法把修改后的状态传给B。</li>
<li>祖先向后代组件传递数据； 需要通过prop一层层的的传递，非常繁琐。</li>
</ol>
</li>
<li><p><strong>vuex</strong></p>
<p>  <strong>集中管理</strong>：vuex把组件的共享状态抽取出来，以一个全局单例模式进行管理，在这种模式下，我们的组件树构成了一个巨大的“视图”，不管在树的哪个位置，任何组件都能获取状态或者触发行为。</p>
<p>  <strong>状态变化可以预测</strong>：不允许组件直接修改状态，而是在vuex内部，通过mutation来修改状态，这样每次状态的变更都可以追踪；<br><img src="https://vuex.vuejs.org/vuex.png" alt="image"></p>
</li>
</ul>
<h2 id="Vuex的核心概念"><a href="#Vuex的核心概念" class="headerlink" title="Vuex的核心概念"></a>Vuex的核心概念</h2><p>每一个 Vuex 应用的核心就是 store（仓库），store集中管理所有的状态。它和单纯的全局对象比有两点不同：</p>
<ol>
<li>vuex中的状态是响应式的，若 store 中的状态发生变化，那么相应的组件也会相应地得到高效更新；</li>
<li>组件不允许直接修改属于store的状态，而应执行 action 来分发 (dispatch) 事件通知 store 去改变，这样使得我们可以方便地跟踪每一个状态的变化；</li>
</ol>
<p>创建store对象的时候需要传递构造器选项，具体如下所示。构造器选项有：state, mutations, actions, getters, modules等，下面是这些选项的用法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">const store = new Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    products: [&#123;&quot;id&quot;: 1, &quot;title&quot;: &quot;iPad 4 Mini&quot;, &quot;price&quot;: 500.01, &quot;inventory&quot;: 2&#125;,</span><br><span class="line">        &#123;&quot;id&quot;: 2, &quot;title&quot;: &quot;H&amp;M T-Shirt White&quot;, &quot;price&quot;: 10.99, &quot;inventory&quot;: 10&#125;,]</span><br><span class="line">  &#125;,</span><br><span class="line">  getters: &#123;</span><br><span class="line">    productsCount: state =&gt; &#123;</span><br><span class="line">        return state.products.length;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    increment (state) &#123;</span><br><span class="line">      state.count++</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>State</strong></li>
</ul>
<p><strong>如何在组件中展示状态？</strong> 通过在vue根实例中注册store选项，store会注入到所有子组件中，这样子组件能通过this.$store访问到。<br>如果组件要显示一个状态，通常会先定义一个计算属性，然后在计算属性返回store中的状态，组件绑定该计算属性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &#123;&#123;productsCount&#125;&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    computed: &#123;</span><br><span class="line">        productsCount() &#123;</span><br><span class="line">         return this.$store.state.productsCount;   </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p><strong>mapState辅助函数</strong><br>当一个组件需要获取多个状态时，将这些状态都声明为计算属性会有些重复和冗余，mapState函数可以帮助我们少输入些代码。</p>
<p>例如: store中有两个状态， name, phone<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> new Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    name: &apos;张绍&apos;,</span><br><span class="line">    phone: &apos;13800138000&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>组件中通过mapState获取这两个状态（ …是ES6中的扩展运算符， 具体用法可参考<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Spread_syntax" target="_blank" rel="noopener">《ES6 … 扩展运算符》</a>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &#123;&#123;name&#125;&#125; / &#123;&#123;phone&#125;&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; mapState &#125; from &apos;vuex&apos;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">    computed: &#123;</span><br><span class="line">        ...mapState([</span><br><span class="line">          &apos;phone&apos;,</span><br><span class="line">          &apos;name&apos;,</span><br><span class="line">        ]),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li><strong>Getter</strong><br>有时候我们组件需要显示加工处理后的状态数据，例如store中有一个待办任务列表的状态数据，但是组件需要显示已完成的待办任务，如果每个组件都在自己的计算属性进行过滤会重复操作，增加代码量。这个时候可以在store中定义一个getter， 在这个getter中进行计算过滤，然后组件的计算属性中直接返回这个getter。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">const store = new Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    todos: [</span><br><span class="line">      &#123; id: 1, text: &apos;...&apos;, done: true &#125;,</span><br><span class="line">      &#123; id: 2, text: &apos;...&apos;, done: false &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  getters: &#123;</span><br><span class="line">    doneTodos: state =&gt; &#123;</span><br><span class="line">      return state.todos.filter(todo =&gt; todo.done)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>组件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">computed: &#123;</span><br><span class="line">  doneTodosCount () &#123;</span><br><span class="line">    return this.$store.getters.doneTodosCount</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Mutation</strong><br>不允许组件直接修改状态，更改状态的唯一方法是提交mutation，然后在mutation中修改；</li>
</ul>
<p>在vuex.store的mutations选项中定义一个mutation, mutation回调函数接收一个参数state，通过state取到状态数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">const store = new Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    count: 1</span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    increment (state) &#123;</span><br><span class="line">      // 变更状态</span><br><span class="line">      state.count++</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>组件中提交mutation更改状态</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;el-button @click=&quot;incrementCount&quot;&gt;修改状态&lt;/el-button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    methods: &#123;</span><br><span class="line">        incrementCount() &#123;</span><br><span class="line">            this.$store.commit(&apos;increment&apos;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Action</strong><br>mutation中的操作是同步的，如果我们需要在异步执行某些操作后修改状态，则只能使用action。 Action可以包含异步操作，在Action中提交mutation来修改状态。</li>
</ul>
<p>定义一个Action</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">const store = new Vuex.Store(&#123;</span><br><span class="line">  ...</span><br><span class="line">  actions: &#123;</span><br><span class="line">    increment (context) &#123;</span><br><span class="line">      setTimeout(() =&gt; &#123;</span><br><span class="line">          context.commit(&apos;increment&apos;)</span><br><span class="line">        &#125;, 1000)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>组件中分发Action</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">this.$store.dispatch(&apos;increment&apos;)</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Module</strong><br>对于一个大型的应用，所有的状态都集中在一个对象中，会变得非常臃肿。vuex允许我们将store分割成模块，每个模块拥有自己的state, mutation, action, getter，甚至是嵌套子模块。类似下面代码：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">const moduleA = &#123;</span><br><span class="line">  state: &#123; ... &#125;,</span><br><span class="line">  mutations: &#123; ... &#125;,</span><br><span class="line">  actions: &#123; ... &#125;,</span><br><span class="line">  getters: &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const moduleB = &#123;</span><br><span class="line">  state: &#123; ... &#125;,</span><br><span class="line">  mutations: &#123; ... &#125;,</span><br><span class="line">  actions: &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const store = new Vuex.Store(&#123;</span><br><span class="line">  modules: &#123;</span><br><span class="line">    a: moduleA,</span><br><span class="line">    b: moduleB</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">store.state.a // -&gt; moduleA 的状态</span><br><span class="line">store.state.b // -&gt; moduleB 的状态</span><br></pre></td></tr></table></figure>
<h2 id="Vuex的安装使用"><a href="#Vuex的安装使用" class="headerlink" title="Vuex的安装使用"></a>Vuex的安装使用</h2><ol>
<li>首先安装vuex</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vuex --save</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>显式地通过Vue.use()，引入vuex</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">import Vuex from &apos;vuex&apos;</span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>实例化Vuex.Store对象</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">const store = new Vuex.Store(&#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;,</span><br><span class="line">  getters: &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">  actions: &#123;</span><br><span class="line">      ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>将store注入到Vue实例中，这样该 store 实例会注入到根组件下的所有子组件中，且子组件能通过 this.$store 访问到</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">new Vue(&#123;</span><br><span class="line">  el: &apos;#app&apos;,</span><br><span class="line">  router,</span><br><span class="line">  store,</span><br><span class="line">  template: &apos;&lt;App/&gt;&apos;,</span><br><span class="line">  components: &#123; App &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>注意事项：对于大型的应用，通常会把vuex相关代码分割到模块中，大概的项目结构如下：(官网有个<a href="https://github.com/vuejs/vuex/tree/dev/examples/shopping-cart" target="_blank" rel="noopener">购物车</a>的例子可以参考)<br><img src="https://note.youdao.com/yws/api/personal/file/DE62C649FAFE4DE891DF9AF656701B36?method=download&amp;shareKey=c5335c54c025ea39551f5afa3ef41fb7" alt="image"></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="https://vuex.vuejs.org/zh/" target="_blank" rel="noopener">Vuex官方文档</a></li>
<li><a href="https://cn.vuejs.org/v2/guide/components.html" target="_blank" rel="noopener">Vue组件</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Spread_syntax" target="_blank" rel="noopener">ES6 … 扩展运算符</a></li>
</ul>
<h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>此文是对官网资料的学习总结，其中夹杂了些自己对vuex的理解，如果有理解有误的地方，欢迎大家指出。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.geeee.top/2018/08/21/number/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jingge">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jingge">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/21/number/" itemprop="url">JS数值类型知识总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-21T18:26:06+08:00">
                2018-08-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/" itemprop="url" rel="index">
                    <span itemprop="name">前端</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/08/21/number/" class="leancloud_visitors" data-flag-title="JS数值类型知识总结">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="整数"><a href="#整数" class="headerlink" title="整数"></a>整数</h3><ul>
<li>十进制</li>
<li>二进制</li>
</ul>
<p>以零为开头，后面接一个小写或大写的拉丁文字母B(0b或者是0B)</p>
<ul>
<li>八进制</li>
</ul>
<p>以0开头，然后是八进制数字序列(0-7) ， 如果字面值中的数值超出范围，那么前导0将被忽略，后面的数值当作十进制解析。</p>
<ul>
<li>十六进制</li>
</ul>
<p>十六进制字面值的前两位必须是 0x，后跟任何十六进制数字（0～9 及 A～F）。其中，字母 A～F可以大写，也可以小写；</p>
<h3 id="浮点数"><a href="#浮点数" class="headerlink" title="浮点数"></a>浮点数</h3><p>保存浮点数需要的内存空间是保存整数值的两倍，因此ECMAScript会不失时机的将浮点数转换为整数值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var floatNum1 = 1.; // 小数点后面没有数字——解析为 1</span><br><span class="line">var floatNum2 = 10.0; // 整数——解析为 10</span><br></pre></td></tr></table></figure>
<p>默认会将小数点后面带有6个零以上的浮点数值转换为以e表示法表示的数值；</p>
<p>浮点数值的最高精度是17位小数；</p>
<h3 id="数值范围"><a href="#数值范围" class="headerlink" title="数值范围"></a>数值范围</h3><p>最大值Number.MAX_VALUE 1.7976931348623157e+308<br>最小值Number.MIN_VALUE 5e-324</p>
<ul>
<li>Number.MIN_VALUE &lt; var1 &lt; Number.MAX_VALUE , isFinite(var1)返回false, 否则返回true</li>
<li><p>如果值超过了js数值范围，那么这个数值自动被转换成特殊的Infinity值。实际情况 Number.MAX_VALUE + 1 还等于 Number.MAX_VALUE；</p>
</li>
<li><p>isFinite()函数判断数值是否位有穷，参数位于最小与最大数值之间时会返回 true</p>
</li>
</ul>
<h3 id="NaN"><a href="#NaN" class="headerlink" title="NaN"></a>NaN</h3><ul>
<li>任何涉及 NaN 的操作（例如 NaN/10）都会返回 NaN</li>
<li>NaN 与任何值都不相等，包括 NaN 本身</li>
<li>实际上只有 0 除以 0 才会返回 NaN，正数除以 0 返回 Infinity，负数除以 0 返回-Infinity</li>
<li>isNaN() 。在接收到一个值之后，会尝试将这个值转换为数值。也适用于对象，先调用对象的valueOf（）判断是否能转成数值，若不能调用toString()再测试返回值。</li>
</ul>
<h3 id="数值转换"><a href="#数值转换" class="headerlink" title="数值转换"></a>数值转换</h3><p>有 3 个函数可以把非数值转换为数值： Number()、 parseInt()和 parseFloat()</p>
<ul>
<li>Number()</li>
</ul>
<ol>
<li>如果是boolean类型， true返回1，false返回0；</li>
<li>如果是数值，只是简单的传入返回；</li>
<li>如果是null，返回0</li>
<li>如果是undefined, 返回NaN;</li>
<li>如果是字符串，字符串如果只包含数字，则将其转换成十进制数；如果是有效的浮点格式，将其转换成对应的浮点数值；如果是二进制或十六进制将其转换成对应的十进制数值；</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">alert(Number(&quot;3.14e5&quot;))；   // 314000</span><br><span class="line">alert(Number(&quot;0b1111&quot;));    // 15, 将二进制转换为十进制</span><br><span class="line">alert(Number(&quot;017&quot;));       // 17, 不会转为8进制</span><br><span class="line">alert(Number(&quot;0x1a&quot;));      // 26， 转换为16进制</span><br><span class="line">alert(Number(&quot;&quot;));          // 空字符串，返回0</span><br><span class="line">alert(Number(&quot;1a&quot;));        // 返回NaN</span><br></pre></td></tr></table></figure>
<ol start="6">
<li>如果是对象，调用对象的valueOf()方法，然后依照前面规则转换，如果valueOf返回值是NaN，则调用toString()方法，再依照前面的规则转换返回的字符串</li>
</ol>
<ul>
<li>parseInt()<br>第一个参数，要解析的数值字符串；第二个参数采用多少进制，不指定基数意味着让 parseInt()决定如何解析输入的字符串；</li>
</ul>
<ol>
<li><p>如果第一个字符不是数字字符或者负号， parseInt()就会返回 NaN；</p>
</li>
<li><p>parseInt()转换空字符串会返回 NaN</p>
</li>
<li><p>如果第一个字符是数字字符， parseInt()会继续解析第二个字符，直到解析完所有后续字符或者遇到了一个非数字字符。</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">parseInt(&quot;1234blue&quot;)    // 1234, blue忽略</span><br><span class="line"></span><br><span class="line">parseInt(&quot;22.5&quot;);   // 22</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>parseInt不能解析二进制的数值，在ES5中，也不能解析八进制的数值；</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">parseInt(&quot;0b1111&quot;);     // 0</span><br><span class="line">parseInt(&quot;071&quot;);    // 71,</span><br></pre></td></tr></table></figure>
<ul>
<li>parseFloat()</li>
</ul>
<ol>
<li>parseFloat()只解析十进制值，因此它没有用第二个参数;</li>
<li>从第一个字符（位置 0）开始解析每个字符。而且也是一直解析到字符串末尾，或者解析到遇见一个无效的浮点数字字符为止;</li>
<li>它始终都会忽略前导的零</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var num1 = parseFloat(&quot;1234blue&quot;); //1234 （整数）</span><br><span class="line">var num2 = parseFloat(&quot;0xA&quot;); //0</span><br><span class="line">var num3 = parseFloat(&quot;22.5&quot;); //22.5</span><br><span class="line">var num4 = parseFloat(&quot;22.34.5&quot;); //22.34</span><br><span class="line">var num5 = parseFloat(&quot;0908.5&quot;); //908.5</span><br><span class="line">var num6 = parseFloat(&quot;3.125e7&quot;); //31250000</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.geeee.top/2018/07/12/table/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jingge">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jingge">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/12/table/" itemprop="url">18章- 表格（学习笔记）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-12T17:08:50+08:00">
                2018-07-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/" itemprop="url" rel="index">
                    <span itemprop="name">前端</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/H5/" itemprop="url" rel="index">
                    <span itemprop="name">H5</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/07/12/table/" class="leancloud_visitors" data-flag-title="18章- 表格（学习笔记）">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="结构化表格"><a href="#结构化表格" class="headerlink" title="结构化表格"></a>结构化表格</h2><p><img src="https://note.youdao.com/yws/api/personal/file/58A81AD539904CCB9A1607209A4D639F?method=download&amp;shareKey=bcdb7a42cc0a3b698c1b2fa111df8aa9" alt="image"></p>
<h2 id="单元格跨行跨列"><a href="#单元格跨行跨列" class="headerlink" title="单元格跨行跨列"></a>单元格跨行跨列</h2><p>rowspan， colspan两个属性；<br>示例代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;thead&gt;</span><br><span class="line">	&lt;tr&gt;</span><br><span class="line">		&lt;th rowspan=&quot;2&quot;&gt;集团编码&lt;/th&gt;</span><br><span class="line">    	&lt;th rowspan=&quot;2&quot;&gt;物品名称&lt;/th&gt;</span><br><span class="line">		&lt;th rowspan=&quot;2&quot;&gt;规格&lt;/th&gt;</span><br><span class="line">		&lt;th rowspan=&quot;2&quot;&gt;批次&lt;/th&gt;</span><br><span class="line">		&lt;th rowspan=&quot;2&quot;&gt;有效期&lt;/th&gt;</span><br><span class="line">		&lt;th colspan=&quot;2&quot;&gt;初期结存&lt;/th&gt;</span><br><span class="line">		&lt;th colspan=&quot;2&quot;&gt;期间入库&lt;/th&gt;</span><br><span class="line">	&lt;/tr&gt;</span><br><span class="line">	&lt;tr&gt;</span><br><span class="line">		&lt;th&gt;数量&lt;/th&gt;</span><br><span class="line">		&lt;th&gt;金额&lt;/th&gt;</span><br><span class="line">		&lt;th&gt;采购数量&lt;/th&gt;</span><br><span class="line">		&lt;th&gt;采购金额&lt;/th&gt;</span><br><span class="line">	&lt;/tr&gt;</span><br><span class="line">&lt;/thead&gt;</span><br></pre></td></tr></table></figure>
<h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><html><head><style type="text/css"><br>html,body {<br>height: 100%;<br>}<br>body {<br>font-size: 14px;<br>margin: 0;<br>padding: 0;<br>}<br>table {<br>width: 100%;<br>border: 0 solid #e3ecdf;<br>border-width: 1px 1px 0 0px;<br>overflow: auto;<br>border-spacing: 0;<br>table-layout: fixed;<br>}<br>caption {<br>font-size: 1.5em;<br>font-style: bold;<br>margin-bottom: 0.8em;<br>}<br>tr {<br>min-height: 30px;<br>text-align: center;height: 35px;} th {background-color: #eff6ee;}td, th {border-width: 0px 0px 1px 1px;border-style: solid;border-color: #e3ecdf;padding: 0;margin: 0;}.tableContent {overflow: auto;max-height: 85%;}</style></head><body><table><caption>库存明细表</caption><thead><tr><th rowspan="2">集团编码</th><th rowspan="2">物品名称</th><th rowspan="2">规格</th><th rowspan="2">批次</th><th rowspan="2">有效期</th><th colspan="2">初期结存</th><th colspan="2">期间入库</th></tr><tr><th>数量</th><th>金额</th><th>采购数量</th><th>采购金额</th></tr></thead><tbody><tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td></tr><tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td></tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><tr><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td></tr></tbody></table></body></html>

<h2 id="单元格间距"><a href="#单元格间距" class="headerlink" title="单元格间距"></a>单元格间距</h2><p>单元格直接默认是有间距的：<br><img src="http://xxling.com/attached/images/2013-04-23-371f6a623f-36dc-4de5-a36b-4f6d2ff9ea96.jpg" alt="image"><br>html5之前通过table的属性cellspacing, cellpadding进行控制；<br>但是在html5中不再支持表格的这两个属性，而是通过border-collapse进行控制，他有两个值一个是collapse，一个是separate（默认）；<br><img src="http://xxling.com/attached/images/2013-04-23-361e967432-1ff4-4b94-b692-3aa901c75403.jpg" alt="image"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.geeee.top/2018/07/05/wpf-popup/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jingge">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jingge">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/05/wpf-popup/" itemprop="url">WPF中Popup遮挡搜狗输入法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-05T15:33:07+08:00">
                2018-07-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/WPF/" itemprop="url" rel="index">
                    <span itemprop="name">WPF</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/07/05/wpf-popup/" class="leancloud_visitors" data-flag-title="WPF中Popup遮挡搜狗输入法">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>用wpf在文本框中输入关键字，然后弹窗显示过滤结果，常见的代码结构为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;grid&gt;</span><br><span class="line">    &lt;TextBox x:name=&quot;txtKeyword&quot;/&gt;</span><br><span class="line">    &lt;Popup Placement=&quot;Bottom&quot;  PlacementTarget=&quot;&#123;Binding ElementName=txtKeyword&#125;&quot; StaysOpen=&quot;False&quot; IsOpen=&quot;&#123;Binding showpopup&#125;&quot;&gt;</span><br><span class="line">    &lt;/Popup&gt;</span><br><span class="line">&lt;/grid&gt;</span><br></pre></td></tr></table></figure>
<p>然而WPF中的Popup默认是置顶的，会显示在页面的最顶层。使用输入法时，有时会出现输入法被Popup遮挡的情况，具体如下图：<br><img src="https://note.youdao.com/yws/api/personal/file/7A9E64C25309452C824E1375B66C338F?method=download&amp;shareKey=ced25374ccd9cf1d57cf3a2888296088" alt="image"></p>
<p>解决办法：</p>
<ol>
<li><strong>创建一个Popup的behavior控制是否置顶</strong><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">public class PopupTopmostBehavior: Behavior&lt;Popup&gt;</span><br><span class="line">	&#123;</span><br><span class="line">		public bool Topmost</span><br><span class="line">		&#123;</span><br><span class="line">			get &#123; return (bool)GetValue(TopmostProperty); &#125;</span><br><span class="line">			set &#123; SetValue(TopmostProperty, value); &#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		// Using a DependencyProperty as the backing store for Topmost.  This enables animation, styling, binding, etc...</span><br><span class="line">		public static readonly DependencyProperty TopmostProperty =</span><br><span class="line">			DependencyProperty.Register(&quot;Topmost&quot;, typeof(bool), typeof(PopupTopmostBehavior), new PropertyMetadata(false, OnTopmostChanged));</span><br><span class="line"></span><br><span class="line">		private static void OnTopmostChanged(DependencyObject obj, DependencyPropertyChangedEventArgs e)</span><br><span class="line">		&#123;</span><br><span class="line">			(obj as PopupTopmostBehavior).UpdateWindow();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		protected override void OnAttached()</span><br><span class="line">		&#123;</span><br><span class="line">			Popup popup = AssociatedObject as Popup;</span><br><span class="line">			if (popup == null)</span><br><span class="line">			&#123;</span><br><span class="line">				throw new ArgumentException(&quot;PopupTopmostBehavior can only be used with a Popup.&quot;);</span><br><span class="line">			&#125;</span><br><span class="line">			popup.Opened += Popup_Opened;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		private void Popup_Opened(object sender, EventArgs e)</span><br><span class="line">		&#123;</span><br><span class="line">			UpdateWindow();</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		protected override void OnDetaching()</span><br><span class="line">		&#123;</span><br><span class="line">			Popup popup = AssociatedObject as Popup;</span><br><span class="line">			if (popup != null)</span><br><span class="line">			&#123;</span><br><span class="line">				popup.Opened -= Popup_Opened;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		private void UpdateWindow()</span><br><span class="line">		&#123;</span><br><span class="line">			Popup pop = AssociatedObject as Popup;</span><br><span class="line">			var hwnd = ((HwndSource)PresentationSource.FromVisual(pop.Child)).Handle;</span><br><span class="line">			RECT rect;</span><br><span class="line"></span><br><span class="line">			if (GetWindowRect(hwnd, out rect))</span><br><span class="line">			&#123;</span><br><span class="line">				SetWindowPos(hwnd, Topmost ? -1 : -2, rect.Left, rect.Top, (int)pop.Width, (int)pop.Height, 0x0010);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		#region P/Invoke imports &amp; definitions</span><br><span class="line"></span><br><span class="line">		[StructLayout(LayoutKind.Sequential)]</span><br><span class="line">		public struct RECT</span><br><span class="line">		&#123;</span><br><span class="line">			public int Left;</span><br><span class="line">			public int Top;</span><br><span class="line">			public int Right;</span><br><span class="line">			public int Bottom;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		[DllImport(&quot;user32.dll&quot;)]</span><br><span class="line">		[return: MarshalAs(UnmanagedType.Bool)]</span><br><span class="line">		private static extern bool GetWindowRect(IntPtr hWnd, out RECT lpRect);</span><br><span class="line"></span><br><span class="line">		[DllImport(&quot;user32&quot;, EntryPoint = &quot;SetWindowPos&quot;)]</span><br><span class="line">		private static extern int SetWindowPos(IntPtr hWnd, int hwndInsertAfter, int x, int y, int cx, int cy, int wFlags);</span><br><span class="line"></span><br><span class="line">		#endregion</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>==这里需要注意下SetWindowPos方法的最后一个参数wFlags，网上好多都直接传0，但是这样会有问题，即Popup打开后文本框会失去焦点，输入操作会被打断。==<br><br>如果想要文本框继续获得焦点，参数wFlag需要传0x0010（SWP_NOACTIVATE），意思就是不激活popup。<br><br>有关SetWindowPos方法的具体参数说明，可参考<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms633545(v=vs.85" target="_blank" rel="noopener">这里</a>.aspx)。</p>
<ol start="2">
<li><strong>在XAML中为popup添加该behavior,注意引入命名空间</strong></li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;UserControl xmlns:i=&quot;http://schemas.microsoft.com/expression/2010/interactivity&quot;&gt;</span><br><span class="line">    &lt;grid&gt;</span><br><span class="line">        &lt;TextBox x:name=&quot;txtKeyword&quot;/&gt;</span><br><span class="line">        &lt;Popup Placement=&quot;Bottom&quot;  PlacementTarget=&quot;&#123;Binding ElementName=txtKeyword&#125;&quot; StaysOpen=&quot;False&quot; IsOpen=&quot;&#123;Binding showpopup&#125;&quot;&gt;</span><br><span class="line">             &lt;i:Interaction.Behaviors&gt;</span><br><span class="line">                &lt;behaviours:PopupTopmostBehavior Topmost=&quot;False&quot; /&gt;</span><br><span class="line">             &lt;/i:Interaction.Behaviors&gt;</span><br><span class="line">        &lt;/Popup&gt;</span><br><span class="line">    &lt;/grid&gt;</span><br><span class="line">&lt;/UserControl&gt;</span><br></pre></td></tr></table></figure>
<p><strong>下图是修改后的效果：</strong></p>
<p><img src="https://note.youdao.com/yws/api/personal/file/E0B91E03717F449EBFA0811DD039D0E5?method=download&amp;shareKey=f4dbd33284215fc9e7885fd1d3c65e38" alt="image"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.geeee.top/2018/06/28/csslayout/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jingge">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jingge">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/28/csslayout/" itemprop="url">11章- CSS进行布局（学习笔记）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-28T18:17:22+08:00">
                2018-06-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/" itemprop="url" rel="index">
                    <span itemprop="name">前端</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/CSS/" itemprop="url" rel="index">
                    <span itemprop="name">CSS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/06/28/csslayout/" class="leancloud_visitors" data-flag-title="11章- CSS进行布局（学习笔记）">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="在旧版浏览器中为HTML5元素添加样式"><a href="#在旧版浏览器中为HTML5元素添加样式" class="headerlink" title="在旧版浏览器中为HTML5元素添加样式"></a>在旧版浏览器中为HTML5元素添加样式</h3><p>大多数浏览器允许对它们并不原生支持的元素添加样式。 Internet Explorer 8 及以下版本是个例外。</p>
<p>(1) 大多数浏览器默认将它们无法识别的元素作为行内元素处理。 因此这一小段 CSS 将强制HTML5 新语义元素显示在单独的行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">article, aside, figcaption, figure, footer, header, main, nav, section &#123;</span><br><span class="line">display: block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>(2) 有 两 种 方 式 可 以 实 现 在 InternetExplorer 9 之前的 IE 中为新的 HTML5 元素设置样式。</p>
<ol>
<li>在每个页面的head中加入以下代码</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=&quot;utf-8&quot; /&gt;</span><br><span class="line">&lt;title&gt;Le Journal&lt;/title&gt;</span><br><span class="line">&lt;link rel=&quot;stylesheet&quot; href=&quot;css/lejournal.css&quot; /&gt;</span><br><span class="line">&lt;!--[if lt IE 9]&gt;</span><br><span class="line">&lt;script src=&quot;http://html5shiv. googlecode.com/svn/trunk/html5.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;![endif]--&gt;</span><br><span class="line">&lt;/head&gt;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>把shiv文件下载到本地</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--[if lt IE 9]&gt;</span><br><span class="line">&lt;script src=&quot;js/html5shiv.js&quot;&gt;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;![endif]--&gt;</span><br></pre></td></tr></table></figure>
<h3 id="对默认样式进行重置或标准化"><a href="#对默认样式进行重置或标准化" class="headerlink" title="对默认样式进行重置或标准化"></a>对默认样式进行重置或标准化</h3><p>每个浏览器都有内置的默认样式表。整体上，不同浏览器提供的默认样式表是相似的， 但也存在一定的差异。 为此，开发人员在应用他们自己的 CSS 之前， 常常需要抹平这些差异。</p>
<ul>
<li><p>使用 CSS 重置（reset）开始主样式表</p>
</li>
<li><p>使用 Nicolas Gallagher 和 Jonathan Neal创建的 normalize.css 开始主样式表</p>
</li>
</ul>
<h3 id="盒模型"><a href="#盒模型" class="headerlink" title="盒模型"></a>盒模型</h3><p>每个元素都包含在一个看不见的盒子里面，这个盒子有内容区域，内边距，边框，外边距构成。</p>
<p><img src="https://note.youdao.com/yws/api/personal/file/DEB455C3226042CAB08DC9F39D316403?method=download&amp;shareKey=4f27044fc05cc1fcc7c5b834bf92d1bc" alt="image"></p>
<p>CSS 中的宽度指示的是内容区域的宽度。而元素在浏览器中的显示宽度则是内容宽度、左右内边距和左右边框的总和。</p>
<p>如果设置了 box-sizing: border-box;，则宽度和高度就包含了除外边距以外的所有要素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">-webkit-box-sizing: border-box;</span><br><span class="line">-moz-box-sizing: border-box;</span><br><span class="line">box-sizing: border-box;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>带有-webkit- 和 -moz- 这些奇怪前缀的属性可以让这些规则在旧的 Android 和 iOS 设备上起作用，同时在Firefox 上也能正常工作。</p>
<h3 id="控制元素的显示类型和可见性"><a href="#控制元素的显示类型和可见性" class="headerlink" title="控制元素的显示类型和可见性"></a>控制元素的显示类型和可见性</h3><p>每个元素在默认情况下，要么显示在单独的行要么显示在行内，前一种称为块级元素，后者则成为行内元素。本质是他们的display属性。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">display: block   // 块级元素</span><br><span class="line">display: inline  // 行内元素</span><br></pre></td></tr></table></figure>
<p>还有一种混合显示方式称为 inlineblock，让元素与其他内容出现在同一行，同时具有块级元素的属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">display: inline-block</span><br></pre></td></tr></table></figure>
<p>还可以通过设置 display 属性让元素完全不在页面上显示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">display: none</span><br></pre></td></tr></table></figure>
<p><strong>控制元素可见性</strong></p>
<p>visibility 属性的主要目的是控制元素是否可见。与 display 属性不同的是，使用visibility 隐藏元素时，元素及其内容应该出现的位置会留下一片空白区域,隐藏元素的空白区域仍然会在文档流中占据位置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">em &#123;</span><br><span class="line">visibility: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="使元素浮动"><a href="#使元素浮动" class="headerlink" title="使元素浮动"></a>使元素浮动</h3><p>只要让一个设置了宽度的元素浮动，在正常情况下显示在它下面的内容就会流动到它的周围。</p>
<p>浮动元素不会影响父元素或其他祖先元素的高度，因此从这一点来说，它不属于文档流的一部分。</p>
<p>例如对如下页面结构是个典型的博客，包括图片、博文、文章页脚，默认情况下文字是显示在图片下方的。通过将图片设置为浮动，文字可环绕图片。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;section class=&quot;post&quot;&gt;</span><br><span class="line">    &lt;img ... class=&quot;post-photo&quot; /&gt;</span><br><span class="line">    &lt;div class=&quot;post-blurb&quot;&gt;</span><br><span class="line">        &lt;p&gt;An hour and a half ...&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;footer class=&quot;footer&quot;&gt;</span><br><span class="line">        &lt;p class=&quot;post-footer&quot;&gt;Posted ...&lt;/p&gt;</span><br><span class="line">    &lt;/footer&gt;</span><br><span class="line">&lt;/section&gt;</span><br></pre></td></tr></table></figure>
<p>CSS:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.post-photo &#123;</span><br><span class="line">    float: left;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>效果：<br><br><br><img src="https://note.youdao.com/yws/api/personal/file/D7BCD18FAF9A4FF790C62E7CA633D3C7?method=download&amp;shareKey=a3894ae5930fbe7627c60056c5092f3d" alt="image"><br><br><br>看似Section的高度受到了图像的影响，但事实并非如此。为了演示这一点，可移除博客中的一些文字。</p>
<p><img src="https://note.youdao.com/yws/api/personal/file/45360472EAD8466892F9C385B8CFE25C?method=download&amp;shareKey=0ec840fa6a12889f01a7459b51597b8a" alt="image"><br><br><br>可以看出，尽管图像是Section的子元素，但是section却比图像更矮一些。只有普通文档流中的内容会影响父元素的高度.<br>上图页脚移到了图像的旁边，这显然不是我们想要的，正常无论内容多长，页脚都应显示在底部。</p>
<p><strong>使用 clear 属性清除浮动效果，如果对某个元素使用该属性， 该元素和它后面的元素就会显示在浮动元素的下面。</strong></p>
<p><img src="https://note.youdao.com/yws/api/personal/file/C290C0AA9BDE4D09BB6909D8A4AA2290?method=download&amp;shareKey=bc7a99977e7ed3d84cf3f286d151325e" alt="image"></p>
<h3 id="对元素进行相对定位"><a href="#对元素进行相对定位" class="headerlink" title="对元素进行相对定位"></a>对元素进行相对定位</h3><p>每个元素在页面文档流中都有一个自然位置，相对于这个原始位置对元素进行移动就称为相对定位。<br>例如：<br><img src="https://note.youdao.com/yws/api/personal/file/FCF948B7459043C0AAEB9393FFE6C9D2?method=download&amp;shareKey=387375bfbbb8ee1c4e14f2158348bb75" alt="image"></p>
<p>提示： 其他元素不会受到偏移的影响，仍然按照这个元素原来的盒子进行排列。</p>
<h3 id="对元素进行绝对定位"><a href="#对元素进行绝对定位" class="headerlink" title="对元素进行绝对定位"></a>对元素进行绝对定位</h3><p>对元素进行绝对定位，是指元素相对于body或者最近已定位祖先元素的精确位置，可以让元素脱离文档流，绝对定位的元素不会再原先的位置上留下空白。</p>
<p>还有一种定位方式：固定定位。当访问者滚动浏览器窗口时， 页面内容通常<br>随之上下移动。 如果对元素设置 position:fixed;，它就会固定在浏览器窗口中。当访问者上下滚动浏览器窗口时， 该元素不会随之移动，页面的其余部分仍照常滚动</p>
<p>对元素设置 position: static 将覆盖position: absolute; 的设置。 static 是元素定位的默认值</p>
<h3 id="在栈中定位元素"><a href="#在栈中定位元素" class="headerlink" title="在栈中定位元素"></a>在栈中定位元素</h3><p>对于定位元素， z-index 最高的数显示在最上面。</p>
<p>z-index 属性仅对定位过的元素（即设为绝对定位、 相对定位或固定定位的元素）有效。</p>
<h3 id="处理溢出"><a href="#处理溢出" class="headerlink" title="处理溢出"></a>处理溢出</h3><p>当元素内容超出盒子大小时会产生溢出，通过overflow可控制元素在盒子外面的部分。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">overflow: visible;   // 让盒子中的元素都可见，默认选项</span><br><span class="line">overflow: hidden;  // 隐藏元素盒子容纳不下的内容</span><br><span class="line">overflow: scroll;  // 无论元素是否需要，都在元素上添加滚动条</span><br><span class="line">overflow: auto;   // 仅当出现溢出时才出现滚动条</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.geeee.top/2018/06/12/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="jingge">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="jingge">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/12/hello-world/" itemprop="url">Hello World</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-12T18:23:49+08:00">
                2018-06-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/前端/" itemprop="url" rel="index">
                    <span itemprop="name">前端</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/06/12/hello-world/" class="leancloud_visitors" data-flag-title="Hello World">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">jingge</p>
              <p class="site-description motion-element" itemprop="description">人生充满着期待，梦想连接着未来。</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">jingge</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("5SBpV2EnxQxGJIpq2lNPwmD5-gzGzoHsz", "UG4cKmb0woQxNBxXgsD4S7Sn");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  

  

  

  

</body>
</html>
